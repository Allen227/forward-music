(window["webpackJsonpmoment-music"]=window["webpackJsonpmoment-music"]||[]).push([[0],{103:function(e,t){},113:function(e,t,n){e.exports=n(209)},123:function(e,t,n){},127:function(e,t,n){},128:function(e,t,n){},184:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(7),i=n.n(r),o=n(37),l=n(38),s=n(58),u=n(55),m=n(59),f=n(11),p=n.n(f),d=n(15),y=n(17),h=n(21),v=n(29),E=n(19);n(123);var g=function(e){var t=e.customStyle;return a.createElement("header",{className:"app-header",style:t},a.createElement("div",{className:"header-bg"}),a.createElement("div",{className:"header-container",style:t},a.createElement(E.b,{to:"recommend"},a.createElement("h1",{className:"app-title"},"MOMENT")),a.createElement("ul",{className:"menu-list"},a.createElement(E.b,{to:"/recommend",className:"menu-item",activeClassName:"active"},a.createElement("li",null,"\u63a8\u8350")),a.createElement(E.b,{to:"/rank",className:"menu-item",activeClassName:"active"},a.createElement("li",null,"\u6392\u884c\u699c")))))},b=(n(210),n(86));n(127),n(128);function S(e){var t=e.href,n=e.customStyle,a=e.event;return c.a.createElement("svg",{className:"icon svg-icon",style:n,"aria-hidden":"true",onClick:function(){return a()}},c.a.createElement("use",{href:"#".concat(t)}))}var O=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,null,[{key:"getInstance",value:function(){return this._instance.loop=!0,this._instance}}]),e}();function N(e){e||(e=0);var t=e/1e3,n=Math.floor(t%60),a=Math.floor(t/60);return"".concat(a<10?"0"+a:a,":").concat(n<10?"0"+n:n)}O._instance=new Audio;var j={value:0,update:function(e){}},_=c.a.createContext(j);var T=function(e){var t=e.customStyle,n=e.setStatus,r=e.status,i=e.stopMusic,o=e.playMusic,l=e.curSongInfo,s=e.playTracks,u=e.fetchSongUrl,m=e.setSource,f=e.fetchLyric,y=O.getInstance(),v=["play-icon"];r&&v.push("active");var E=Object(a.useState)(100*y.volume),g=Object(h.a)(E,2),j=g[0],T=g[1],k=Object(a.useState)(y.currentTime),C=Object(h.a)(k,2),w=C[0],x=C[1],I=Object(a.useState)(!1),R=Object(h.a)(I,2),L=R[0],U=R[1],M=Object(a.useContext)(_),A={width:32,height:32};function D(){return(D=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}i(),e.next=11;break;case 4:return e.next=6,u(l.id);case 6:t=e.sent,l.source=t.data[0].url,m(l),F(w),o();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){var t=s.findIndex((function(e){return e.id===l.id}));-1===e?function(e){e>0&&m(s[e-1])}(t):1===e&&function(e){e<s.length-1&&m(s[e+1])}(t),o(),n(!0)}function F(e){U(!1),x(e),y.currentTime=e}return y.ontimeupdate=function(e){if(!L){var t=e.path[0].currentTime;x(t),M.update(t)}},Object(a.useEffect)((function(){y.volume=.25,T(100*y.volume)}),[]),Object(a.useEffect)((function(){f(l.id)}),[l.id]),c.a.createElement("footer",{className:"app-footer",style:t},c.a.createElement("div",{className:"footer-bg"}),c.a.createElement("div",{className:"footer-container"},c.a.createElement("div",{className:"player-control"},c.a.createElement(S,{href:"iconshangyige",customStyle:A,event:function(){return H(-1)}}),c.a.createElement("div",{className:"play-btn",onClick:function(){return D.apply(this,arguments)}},c.a.createElement("div",{className:v.join(" ")})),c.a.createElement(S,{href:"iconxiayige",customStyle:A,event:function(){return H(1)}})),c.a.createElement("div",{className:"time-bar"},c.a.createElement("span",{className:"slide-time"},N(1e3*w)),c.a.createElement(b.a,{onChange:function(e){U(!0),x(e)},onAfterChange:F,value:w,min:0,max:Math.round(l.dt/1e3),tipFormatter:null}),c.a.createElement("span",{className:"slide-time"},N(l.dt))),c.a.createElement("div",{className:"volume-bar"},c.a.createElement(S,{href:"iconyinliang",customStyle:{width:20,height:20},event:function(){}}),c.a.createElement(b.a,{onChange:function(e){T(e),y.volume=e/100},min:0,max:100,onAfterChange:function(){return o()},value:j,tipFormatter:null}))))},k=(n(100),n(56)),C=(n(184),n(39));var w=function(e){var t,n=e.deleteTrack,a=e.curSongInfo,r=e.fetchSongUrl,i=e.loadSource,o=e.setSource,l=e.setStatus,s=e.playMusic,u=e.customStyle,m=e.playTracks,f=localStorage.getItem("songTracks"),y=Object(v.g)();function h(){return(h=Object(d.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.id);case 2:(n=e.sent).data[0].url?(a={id:t.id,name:t.name,picUrl:t.picUrl,source:n.data[0].url,player:t.player,dt:t.dt},o(a),i(),s(),l(!0)):k.a.warn("\u6b4c\u66f2\u4e0d\u5b58\u5728");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f&&(t=m.map((function(e,t){return c.a.createElement("li",{className:"list-item",key:e.id,onClick:function(){!function(e){h.apply(this,arguments)}(e)}},c.a.createElement("span",{className:"song-name text-overflow"},e.name),c.a.createElement("span",{className:"song-time"},N(e.dt)),c.a.createElement(S,{href:"iconlajitong",event:function(){n(t)}}))})));var E,g=["cur-music-box"];return a.id?g.push("active"):E={height:"calc(100% - 40px)"},c.a.createElement("aside",{className:"left-side",style:u},c.a.createElement("h2",{className:"title",style:u},"\u64ad\u653e\u5217\u8868"),c.a.createElement("div",{className:"track-container",style:E},c.a.createElement(C.Scrollbars,{style:{width:"100%",height:"100%"},autoHide:!0},c.a.createElement("ul",{className:"track-list"},t))),c.a.createElement("div",{className:g.join(" "),style:u},c.a.createElement(S,{href:"iconfangda",event:function(){y.push({pathname:"/song",state:{id:a.id}})}}),c.a.createElement("img",{className:"music-img",src:"".concat(a.picUrl,"?param=60y60"),alt:"song-cover"}),c.a.createElement("div",{className:"music-info"},c.a.createElement("h3",{className:"music-title text-overflow"},a.name),c.a.createElement("span",{className:"music-time",style:u},a.player,"\xa0\xa0\xa0",N(a.dt)))))};n(202);function x(e){var t=e.recommendList,n=e.rankList,a=e.type,r=Object(v.g)();var i=[];t&&"recommend"===a?i=t:n&&"rank"===a&&(i=n);var o=i.map((function(e){return c.a.createElement("li",{className:"box-item",key:e.id,onClick:function(){return function(e){var t;t={pathname:"".concat(a,"/detail"),state:{id:e}},r.push(t)}(e.id)}},c.a.createElement("div",{className:"img-box"},c.a.createElement("img",{className:"img",src:"".concat(e.coverImgUrl,"?param=200y200"),alt:"box-cover"})),c.a.createElement("div",{className:"box-title"},e.name))}));return c.a.createElement(C.Scrollbars,{style:{width:"100%",height:"100%"},autoHide:!0},c.a.createElement("ul",{className:"box-list"},o))}n(203);var I="FETCH_RECOMMEND_TAGS_SUCCESS",R="FETCH_RECOMMEND_TAGS_ERROR",L="FETCH_RECOMMEND_DETAIL_TAGS_SUCCESS",U="FETCH_RECOMMEND_DETAIL_TAGS_ERROR",M="FETCH_PLAYLIST_DETAIL_SUCCESS",A="FETCH_PLAYLIST_DETAIL_ERROR",D="FETCH_SONG_URL_SUCCESS",H="FFETCH_RANK_LIST_SUCCESS",F="FETCH_RANK_LIST_ERROR",P="FETCH_LYRIC_SUCCESS",G="FETCH_LYRIC_ERROR",J="PLAY_MUSIC",K="STOP_MUSIC",Y="SET_SOURCE",q="LOAD_SOURCE",W="SET_LOOP",B="SET_PLAY_INDEX",X="SET_STATUS";var z=function(e,t,n){return fetch(e,{method:t,body:JSON.stringify(n)}).then((function(e){return e.json()}))},Q="http://129.226.190.242:3000",V={fetch_recommend_tags:function(){return z("".concat(Q,"/playlist/hot"),"GET")},fetch_recommend_tags_detail:function(e){return z("".concat(Q,"/top/playlist?limit=30&cat=").concat(e),"GET")},fetch_playlist_detail:function(e){return z("".concat(Q,"/playlist/detail?id=").concat(e),"GET")},fetch_song_url:function(e){return z("".concat(Q,"/song/url?id=").concat(e),"GET")},fetch_rank_list:function(){return z("".concat(Q,"/toplist"),"GET")},fetch_lyric:function(e){return z("".concat(Q,"/lyric?id=").concat(e),"GET")}},Z=function(){return function(e){V.fetch_recommend_tags().then((function(t){e({type:I,payload:t})})).catch((function(t){e({type:R,payload:t})}))}},$=function(e){return function(t){V.fetch_recommend_tags_detail(e).then((function(e){t(function(e){var t=[];return 200===e.code&&e.playlists.forEach((function(e){t.find((function(t){return t.id===e.id}))||t.push(e)})),{type:L,payload:{playlists:t}}}(e))})).catch((function(e){t({type:U,payload:e})}))}},ee=function(e){return function(t){V.fetch_playlist_detail(e).then((function(e){t({type:M,payload:e})})).catch((function(e){t({type:A,payload:e})}))}},te=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.fetch_song_url(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ne(){return{type:J,payload:!0}}function ae(){return{type:q,payload:null}}function ce(e){return{type:Y,payload:e}}function re(e){return{type:X,payload:e}}var ie=function(){return function(e){V.fetch_rank_list().then((function(t){e({type:H,payload:t})})).catch((function(t){e({type:F,payload:t})}))}},oe=(n(51),n(45),n(52),n(80),n(103),function(e){return function(t){V.fetch_lyric(e).then((function(e){t({type:P,payload:e})})).catch((function(e){t({type:G,payload:e})}))}});var le=Object(y.b)((function(e){return e}),(function(e){return{fetchRankList:function(){return e(ie())}}}))((function(e){var t,n=e.fetchRankList,r=e.rankList;return Object(a.useEffect)((function(){n()}),[]),r&&r.list&&(t=c.a.createElement(x,{rankList:r.list,type:"rank"})),c.a.createElement("div",{className:"rank"},t)})),se=(n(204),[]),ue=function(){var e=-1;return function(t){var n=0,a=void 0,c=!0,r=!1,i=void 0;try{for(var o,l=se[Symbol.iterator]();!(c=(o=l.next()).done);c=!0){if(o.value.time.includes(t)){a=n;break}n++}}catch(s){r=!0,i=s}finally{try{c||null==l.return||l.return()}finally{if(r)throw i}}return void 0===a?a=e:e=a,a}}();var me=Object(y.b)((function(e){return e}),(function(e){return{fetchLyric:function(t){return e(oe(t))}}}))((function(e){var t,n=e.fetchLyric,r=e.lyricData,i=e.curSongInfo,o=Object(v.h)(),l=Object(a.useContext)(_),s=Object(a.useState)(0),u=Object(h.a)(s,2),m=u[0],f=u[1],p=o.state.id;Object(a.useEffect)((function(){var e=document.querySelector(".lyric-list");e&&m>7&&(e.style.top="-".concat(30*(m-7),"px"))}),[m]),Object(a.useEffect)((function(){n(p)}),[]),Object(a.useEffect)((function(){var e=document.querySelector(".lyric-list");f(0),e.removeAttribute("style")}),[i.id]),Object(a.useEffect)((function(){se=[];var e="";r&&r.lrc&&(e=r.lrc.lyric),se=function(){var t=e.split("\n"),n=[];return t.map((function(e){(n=e.match(/\[\d{2}:\d{2}.(\d{2}|\d{3})\]/))&&se.push({time:n[0].slice(1,-1),value:e.slice(n[0].length).trim()})})),se}()}));var d=se.map((function(e,n){var a=["lyric-line"];return(t=ue(N(1e3*l.value)))!==m&&f(t),m===n&&a.push("active"),c.a.createElement("li",{className:a.join(" "),key:n},e.value)}));return c.a.createElement("div",{className:"song"},c.a.createElement("ul",{className:"lyric-list"},d))}));n(205);var fe=Object(y.b)((function(e){return e}),(function(e){return{fetchPlaylistDetail:function(t){return e(ee(t))},fetchSongUrl:function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),playMusic:function(){return e(ne())},loadSource:function(){return e(ae())},setSource:function(t){return e(ce(t))},setLoop:function(){return e({type:W})},pushPlayTracks:function(t){return e(function(e){return{type:"PUSH_TRACKS",payload:e}}(t))},setStatus:function(t){return e(re(t))}}}))((function(e){var t,n,r=e.fetchPlaylistDetail,i=e.playlistDetail,o=e.fetchSongUrl,l=e.playMusic,s=e.loadSource,u=e.setSource,m=(e.setLoop,e.pushPlayTracks),f=e.setStatus,y=Object(v.h)().state.id;function h(){return(h=Object(d.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t.id);case 2:(n=e.sent).data[0].url?(a={id:t.id,name:t.name,picUrl:t.al.picUrl,source:n.data[0].url,player:t.ar[0].name,dt:t.dt},u(a),s(),l(),m(a),f(!0)):k.a.warn("\u6b4c\u66f2\u4e0d\u5b58\u5728");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(Object(a.useEffect)((function(){r(y)}),[]),i.playlist){var E=i.playlist;n=E.tracks.map((function(e,t){return c.a.createElement("div",{className:"table-row",key:e.id,onClick:function(){return function(e){return h.apply(this,arguments)}(e)}},c.a.createElement("span",{className:"table-cell track-index"},t+1),c.a.createElement("span",{className:"table-cell song-name"},e.name),c.a.createElement("span",{className:"table-cell song-player"},e.ar[0].name),c.a.createElement("span",{className:"table-cell song-time"},N(e.dt)))})),t=c.a.createElement("div",{className:"playlist-top"},c.a.createElement("img",{className:"playlist-cover",src:"".concat(E.coverImgUrl,"?param=200y200"),alt:"playlist cover"}),c.a.createElement("div",{className:"playlist-info"},c.a.createElement("h2",{className:"playlist-title"},E.name),c.a.createElement("p",{className:"playlist-desc"},E.description)))}return c.a.createElement("div",{className:"playlist-detail"},c.a.createElement(C.Scrollbars,{style:{width:"100%",height:"100%"},autoHide:!0},t,c.a.createElement("div",{className:"table-wrapper"},c.a.createElement("div",{className:"table-title"},c.a.createElement("div",{className:"title-item"}),c.a.createElement("div",{className:"title-item"},"\u6b4c\u66f2"),c.a.createElement("div",{className:"title-item"},"\u6b4c\u624b"),c.a.createElement("div",{className:"title-item"},"\u65f6\u957f")),c.a.createElement("div",{className:"table-content"},n))))}));n(206);var pe=Object(y.b)((function(e){return e}),(function(e){return{fetchRemmendTags:function(){return e(Z())},fetchRecommendDetail:function(t){return e($(t))}}}))((function(e){var t,n,r=e.recommendTags,i=e.recommendTagDetail,o=e.fetchRemmendTags,l=e.fetchRecommendDetail,s=Object(a.useState)("\u534e\u8bed"),u=Object(h.a)(s,2),m=u[0],f=u[1];return Object(a.useEffect)((function(){void 0===r.code&&o(),Object.keys(r).length>0&&l(r.tags[0].name)}),[r.code]),r&&r.tags&&(t=r.tags.map((function(e){var t=["tag"];return m===e.name&&t.push("active"),c.a.createElement("li",{className:t.join(" "),key:e.id,onClick:function(){return f((t=e).name),void l(t.name);var t}},e.name)}))),Object.keys(i).length>0&&(n=c.a.createElement(x,{recommendList:i.playlists,type:"recommend"})),c.a.createElement("div",{className:"recommend"},c.a.createElement("ul",{className:"tags-list"},t),n)}));n(207);var de=Object(y.b)((function(e){return e}),(function(e){return{loadSource:function(){return e(ae())},setSource:function(t){return e(ce(t))},stopMusic:function(){return e({type:K,payload:!1})},playMusic:function(){return e(ne())},setStatus:function(t){return e(re(t))},fetchSongUrl:function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchLyric:function(t){return e(oe(t))},deleteTrack:function(t){return e(function(e){return{type:"DELETE_TRACKS",payload:e}}(t))}}}))((function(e){var t=e.setStatus,n=e.curSongInfo,r=e.stopMusic,i=e.playMusic,o=e.playTracks,l=e.loadSource,s=e.setSource,u=e.fetchSongUrl,m=e.fetchLyric,f=e.deleteTrack,p=Object(a.useState)(j),d=Object(h.a)(p,2),y=d[0],E=d[1],b={value:y,update:function(e){E(e)}},S={},O={};return!!Object(v.i)("/song")&&(S={backgroundImage:"url(".concat(n.picUrl,"?param=").concat(document.body.offsetWidth/3.9,"y").concat(document.body.offsetHeight/3.9,")")},O={background:"none",border:"none",color:"white"}),c.a.createElement(_.Provider,{value:b},c.a.createElement("div",{className:"home-bg",style:S}),c.a.createElement("div",{className:"home"},c.a.createElement(g,{customStyle:O}),c.a.createElement("main",{className:"app-main",style:O},c.a.createElement(w,{deleteTrack:f,playTracks:o,customStyle:O,curSongInfo:n,playMusic:i,loadSource:l,setSource:s,setStatus:t,fetchSongUrl:u}),c.a.createElement("article",{className:"container",style:O},c.a.createElement(v.d,null,c.a.createElement(v.a,{from:"/",exact:!0,to:"/recommend"}),c.a.createElement(v.b,{path:"/recommend",component:pe,exact:!0}),c.a.createElement(v.b,{path:"/recommend/detail",component:fe}),c.a.createElement(v.b,{path:"/rank/detail",component:fe}),c.a.createElement(v.b,{path:"/rank",component:le,exact:!0}),c.a.createElement(v.b,{path:"/song",component:me,exact:!0})))),c.a.createElement(T,{customStyle:O,status:n.status,stopMusic:r,playMusic:i,playTracks:o,curSongInfo:n,setSource:s,setStatus:t,fetchSongUrl:u,fetchLyric:m})))})),ye=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return a.createElement(E.a,null,a.createElement(v.b,{path:"/",component:de}))}}]),t}(a.Component),he=n(27);var ve=Object(he.combineReducers)({recommendTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object.assign({},e,t.payload)}return e},recommendTagDetail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return Object.assign({},e,t.payload)}return e},playlistDetail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object.assign({},e,t.payload)}return e},songUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object.assign({},e,t.payload)}return e},curSongInfo:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,a=O.getInstance(),c=localStorage.getItem("curSongInfo");switch(c&&(e=JSON.parse(c)),n.type){case J:return!a.src&&c&&(a.src=e.source),a.play(),Object.assign({},t,{status:n.payload});case K:return a.pause(),Object.assign({},t,{status:n.payload});case Y:return a.src=n.payload.source,localStorage.setItem("curSongInfo",JSON.stringify(n.payload)),Object.assign({},t,n.payload);case q:a.load();break;case B:return Object.assign({},t,{playIndex:n.payload});case X:return Object.assign({},t,{status:n.payload})}return Object.assign({},t,e)},playTracks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=localStorage.getItem("songTracks"),a=[];function c(e){return a.find((function(t){return t.id===e.id}))||a.push(e),localStorage.setItem("songTracks",JSON.stringify(a)),a}function r(e){return a.splice(e,1),localStorage.setItem("songTracks",JSON.stringify(a)),a}switch(n&&(e=a=JSON.parse(n)),t.type){case"PUSH_TRACKS":return c(t.payload);case"DELETE_TRACKS":return r(t.payload)}return e},rankList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return Object.assign({},e,t.payload)}return e},lyricData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return Object.assign({},e,t.payload)}return e}}),Ee=n(110),ge=n(111),be=Object(he.createStore)(ve,Object(ge.composeWithDevTools)(Object(he.applyMiddleware)(Ee.a))),Se=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return a.createElement(y.a,{store:be},a.createElement(ye,null))}}]),t}(a.Component);n(208);i.a.render(c.a.createElement(Se,null),document.getElementById("root"))},45:function(e,t){},51:function(e,t){},52:function(e,t){},80:function(e,t){}},[[113,1,2]]]);
//# sourceMappingURL=main.77383b0b.chunk.js.map